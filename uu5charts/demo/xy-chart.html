<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XyChart</title>

    <script src="https://cdn.plus4u.net/uu-uu5loaderg01/1.0.0/uu5loaderg01.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.plus4u.net/uu-uu5g05/1.0.0/assets/example-config.js" crossorigin="anonymous"></script>
    <script src="https://cdn.plus4u.net/uu-uu5tilesg02/2.0.0/assets/example-config.js" crossorigin="anonymous"></script>

    <script>
      Uu5Loader.config({
        imports: {
          "uu5charts": "/uu5charts.js"
        },
      });
    </script>

    <style>
      body {
        padding: 16px 32px;
      }
    </style>
  </head>
  <body>
    <div id="uu5">Loading...</div>

    <script type="text/babel">
      import { Utils } from "uu5g05";
      import Uu5Elements from "uu5g05-elements";
      import { Config } from "uu5g05-dev";
      import { XyChart, carsData } from "uu5charts";

      // <XyChart
      //   data={data}
      //   series={[{ valueKey: "Horsepower", title: "Výkon" }, { valueKey: "Horsepower", line: true, color: "red", title: "Čára" }]}
      //   labelAxis={{ dataKey: "Miles_per_Gallon", title: "Spotřeba", unit: " MpG" }}
      //   valueAxis={{ title: "Výkon", unit: " W" }}
      //   legend
      // />

      const data = [
        {
          "month": "Leden",
          "apples": 10,
          "bananas": 20,
        },
        {
          "month": "Únor",
          "apples": 12,
          "bananas": 18,
        },
        {
          "month": "Březen",
          "apples": 22,
          "bananas": 8,
        },
        {
          "month": "Duben",
          "apples": 17,
          "bananas": 14,
        },
        {
          "month": "Květen",
          "apples": 20,
          "bananas": 12,
        }
      ].map((item) => ({ ...item, sum: item.apples + item.bananas }));


      function Page() {
        // const cleanData = carsData.filter(item => item["Miles_per_Gallon"] != null && item["Horsepower"] != null)
        //
        // const groupMap = cleanData.reduce((obj, item) => {
        //   if (item["Miles_per_Gallon"]) {
        //     obj[item["Miles_per_Gallon"]] ||= { itemList: [] };
        //     obj[item["Miles_per_Gallon"]].itemList.push(item);
        //   }
        //   return obj;
        // }, {});
        //
        // for (let key in groupMap) {
        //   groupMap[key].avg = groupMap[key].itemList.reduce((sum, item) => {
        //     sum += item["Horsepower"];
        //     return sum;
        //   }, 0) / groupMap[key].itemList.length;
        // }
        //
        // const data = cleanData.map((item, i, arr) => {
        //   if (item["Miles_per_Gallon"]) {
        //     return {
        //       ...item,
        //       avg: groupMap[item["Miles_per_Gallon"]].avg,
        //       avg2: groupMap[item["Miles_per_Gallon"]].avg + groupMap[arr[(i || arr.length) - 1]["Miles_per_Gallon"]].avg / 5
        //     };
        //   }
        //   return item;
        // });
        //
        // console.log(data);

        return (
          <div>
            <Uu5Elements.Block headerType="heading" level={4} header="Data" collapsible initialCollapsed>
              <pre>{"[\n  " + JSON.stringify(data, null, 4).replace(/}/, "  }") + ",\n  ...\n]"}</pre>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="default" collapsible>
              <XyChart
                data={data}
                series={[{ valueKey: "apples" }]}
                labelAxis={{ dataKey: "month" }}
              />
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Series" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="color, title, onClick, label">
                  <XyChart
                    data={data}
                    series={[
                      {
                        valueKey: "apples",
                        color: "green",
                        title: "Jablka",
                        onClick: (e) => console.log("click", e),
                        label: true
                      },
                      {
                        valueKey: "bananas",
                        color: "#ffeb3b",
                        title: "Banány",
                        onClick: (e) => console.log("click", e),
                        label: {
                          content: (props) => {
                            const { x, y, offset, value } = props;

                            return (
                              <text x={x} y={y} dx={offset} dy={-offset} fill="#ffeb3b" textAnchor="middle">
                                {value}
                              </text>
                            );
                          },
                        }
                      },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Point" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples", point: true }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="shape: star">
                  <XyChart
                    data={data}
                    series={[{
                      valueKey: "apples",
                      point: { shape: "star" },
                    }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Line" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples", line: true }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="point: true, type: basis, width: 2">
                  <XyChart
                    data={data}
                    series={[{
                      valueKey: "apples",
                      line: { point: true, type: "basis", width: 2 },
                    }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Area" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples", area: true }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="point: true, type: basis">
                  <XyChart
                    data={data}
                    series={[{
                      valueKey: "apples",
                      area: { point: true, type: "basis" },
                    }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Bar" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples", bar: true }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="barSize: 20">
                  <XyChart
                    data={data}
                    series={[{
                      valueKey: "apples",
                      bar: { barSize: 20 },
                    }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="layout: vertical">
                  <XyChart
                    data={data}
                    layout="vertical"
                    series={[{
                      valueKey: "apples",
                      bar: true,
                    }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Combinations" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples" }, { valueKey: "bananas" }]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="color, types">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", color: "green", bar: true },
                      { valueKey: "bananas", color: "yellow", bar: true },
                      { valueKey: "sum", line: true },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="color, area, stackId">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", color: "green", area: { stackId: "1" } },
                      { valueKey: "bananas", color: "yellow", area: { stackId: "1" } },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Axises" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="title, unit">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples" }]}
                    labelAxis={{ dataKey: "month", title: "Měsíc" }}
                    valueAxis={{ title: "Počet", unit: " ks" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="displayCartesianGrid">
                  <XyChart
                    data={data}
                    series={[{ valueKey: "apples" }]}
                    labelAxis={{ dataKey: "month" }}
                    displayCartesianGrid
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Legend" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="default">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", title: "Jablka", color: "green" },
                      { valueKey: "bananas", title: "Banány", color: "yellow" },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                    legend
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="title, position">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", title: "Jablka", color: "green" },
                      { valueKey: "bananas", title: "Banány", color: "yellow" },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                    legend={{ title: "Ovoce", position: "bottom-center" }}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="custom">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", title: "Jablka", color: "green" },
                      { valueKey: "bananas", title: "Banány", color: "yellow" },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                    legend={{
                      position: "bottom-left",
                      children: (props) => {
                        // console.log("custom label props", props);
                        const { payload } = props;
                        return (
                          <Uu5Elements.Tile header="Legenda">
                            {payload.map((item, i) => {
                              // console.log("custom label item", item);
                              const { color, value } = item;
                              return (
                                <Uu5Elements.MenuItem key={i}>
                                  <Uu5Elements.Badge
                                    borderRadius="full"
                                    style={{ backgroundColor: color, marginRight: 8 }}
                                  />
                                  {value}
                                </Uu5Elements.MenuItem>
                              )
                            })}
                          </Uu5Elements.Tile>
                        )
                      }
                    }}
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>

            <Uu5Elements.Block headerType="heading" level={4} header="Tooltip" collapsible>
              <div className={Config.Css.css({
                display: "grid",
                gridTemplateColumns: "repeat(auto-fit, minmax(300px, 1fr))",
                gap: 16,
              })}>
                <Uu5Elements.Block headerType="heading" header="false">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", title: "Jablka", color: "green" },
                      { valueKey: "bananas", title: "Banány", color: "yellow" },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                    tooltip={false}
                  />
                </Uu5Elements.Block>

                <Uu5Elements.Block headerType="heading" header="custom">
                  <XyChart
                    data={data}
                    series={[
                      { valueKey: "apples", title: "Jablka", color: "green" },
                      { valueKey: "bananas", title: "Banány", color: "yellow" },
                    ]}
                    labelAxis={{ dataKey: "month" }}
                    tooltip={(props) => {
                        // console.log("custom tooltip props", props);
                        const { payload } = props;
                        return (
                          <Uu5Elements.Tile header="Tooltip">
                            {payload.map((item, i) => {
                              // console.log("custom tooltip item", item);
                              const { color, name, value } = item;
                              return (
                                <Uu5Elements.MenuItem key={i}>
                                  <Uu5Elements.Badge
                                    borderRadius="full"
                                    style={{ backgroundColor: color, marginRight: 8 }}
                                  />
                                  {name}: {value}
                                </Uu5Elements.MenuItem>
                              )
                            })}
                          </Uu5Elements.Tile>
                        )
                      }
                    }
                  />
                </Uu5Elements.Block>
              </div>
            </Uu5Elements.Block>
          </div>
        );
      }

      Utils.Dom.render(<Page />, document.getElementById("uu5"));
    </script>
  </body>
</html>
